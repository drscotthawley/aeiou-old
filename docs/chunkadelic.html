---

title: chunkadelic


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/chunkadelic.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/chunkadelic.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img src="/shazbot/images/chunkadelic.png" alt="chunkadelic.png"></p>
<blockquote><p>Preprocesses a dataset of disparate-sized audio files into entirely uniform chunks</p>
</blockquote>
<p>Note:Duplicates the directory structure(s) referenced by input paths.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="load_file" class="doc_header"><code>load_file</code><a href="https://github.com/drscotthawley/shazbot/tree/master/shazbot/chunkadelic.py#L20" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>load_file</code>(<strong><code>filename</code></strong>:<code>str</code>, <strong><code>sr</code></strong>=<em><code>48000</code></em>)</p>
</blockquote>
<p>this loads an audio file as a torch tensor</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>filename</code></strong></td>
<td><code>str</code></td>
<td></td>
<td>file to load</td>
</tr>
<tr>
<td><strong><code>sr</code></strong></td>
<td><code>int</code></td>
<td><code>48000</code></td>
<td>sample rate to read/resample at</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="makedir" class="doc_header"><code>makedir</code><a href="https://github.com/drscotthawley/shazbot/tree/master/shazbot/chunkadelic.py#L33" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>makedir</code>(<strong><code>path</code></strong>:<code>str</code>)</p>
</blockquote>
<p>creates directories where they don't exist</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>path</code></strong></td>
<td><code>str</code></td>
<td></td>
<td>directory or nested directory</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="blow_chunks" class="doc_header"><code>blow_chunks</code><a href="https://github.com/drscotthawley/shazbot/tree/master/shazbot/chunkadelic.py#L45" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>blow_chunks</code>(<strong><code>audio</code></strong>:<code>_VariableFunctionsClass.tensor</code>, <strong><code>new_filename</code></strong>:<code>str</code>, <strong><code>chunk_size</code></strong>:<code>int</code>, <strong><code>sr</code></strong>=<em><code>48000</code></em>, <strong><code>overlap</code></strong>=<em><code>0.5</code></em>, <strong><code>strip</code></strong>=<em><code>False</code></em>, <strong><code>thresh</code></strong>=<em><code>-70</code></em>)</p>
</blockquote>
<p>chunks up the audio and saves them with --{i} on the end of each chunk filename</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>audio</code></strong></td>
<td><code>_VariableFunctionsClass.tensor</code></td>
<td></td>
<td>long audio file to be chunked</td>
</tr>
<tr>
<td><strong><code>new_filename</code></strong></td>
<td><code>str</code></td>
<td></td>
<td>stem of new filename(s) to be output as chunks</td>
</tr>
<tr>
<td><strong><code>chunk_size</code></strong></td>
<td><code>int</code></td>
<td></td>
<td>how big each audio chunk is, in samples</td>
</tr>
<tr>
<td><strong><code>sr</code></strong></td>
<td><code>int</code></td>
<td><code>48000</code></td>
<td>audio sample rate in Hz</td>
</tr>
<tr>
<td><strong><code>overlap</code></strong></td>
<td><code>float</code></td>
<td><code>0.5</code></td>
<td>fraction of each chunk to overlap between hops</td>
</tr>
<tr>
<td><strong><code>strip</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>strip silence: chunks with max power in dB below this value will not be saved to files</td>
</tr>
<tr>
<td><strong><code>thresh</code></strong></td>
<td><code>int</code></td>
<td><code>-70</code></td>
<td>threshold in dB for determining what counts as silence</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="process_one_file" class="doc_header"><code>process_one_file</code><a href="https://github.com/drscotthawley/shazbot/tree/master/shazbot/chunkadelic.py#L73" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>process_one_file</code>(<strong><code>filenames</code></strong>:<code>list</code>, <strong><code>args</code></strong>, <strong><code>file_ind</code></strong>)</p>
</blockquote>
<p>this chunks up one file</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>filenames</code></strong></td>
<td><code>list</code></td>
<td></td>
<td>list of filenames from which we'll pick one</td>
</tr>
<tr>
<td><strong><code>args</code></strong></td>
<td></td>
<td></td>
<td>output of argparse</td>
</tr>
<tr>
<td><strong><code>file_ind</code></strong></td>
<td></td>
<td></td>
<td>index from filenames list to read from</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="main" class="doc_header"><code>main</code><a href="https://github.com/drscotthawley/shazbot/tree/master/shazbot/chunkadelic.py#L104" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>main</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">

<pre><code>usage: chunkadelic [-h] [--chunk_size CHUNK_SIZE] [--sr SR] [--overlap OVERLAP] [--strip] [--thresh THRESH] output_path input_paths [input_paths ...]

positional arguments:
  output_path           Path of output for chunkified data
  input_paths           Path(s) of a file or a folder of files. (recursive)

options:
  -h, --help            show this help message and exit
  --chunk_size CHUNK_SIZE
                        Length of chunks (default: 131072)
  --sr SR               Output sample rate (default: 48000)
  --overlap OVERLAP     Overlap factor (default: 0.5)
  --strip               Strips silence: chunks with max dB below &lt;thresh&gt; are not outputted (default: False)
  --thresh THRESH       threshold in dB for determining what constitutes silence (default: -70)</code></pre>

</div>
</div>
</div>
</div>


